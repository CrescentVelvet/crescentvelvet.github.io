---
permalink: /game.html
layout: null
title: "é£æœºå¤§æˆ˜å°æ¸¸æˆ"
---
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é£æœºå¤§æˆ˜å°æ¸¸æˆ</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #000;
            touch-action: none;
        }
        canvas {
            border: 2px solid #fff;
            max-width: 100vw;
            max-height: 100vh;
        }
        #gameInfo {
            position: fixed;
            top: 10px;
            left: 10px;
            color: #fff;
            font-size: 16px;
            font-family: Arial, sans-serif;
            line-height: 1.5;
            z-index: 100;
        }
        #lastModified {
            position: fixed;
            top: 10px;
            right: 10px;
            color: #fff;
            font-size: 14px;
            font-family: Arial, sans-serif;
            background: rgba(0, 0, 0, 0.5);
            padding: 5px 10px;
            border-radius: 5px;
            z-index: 100;
        }
        .game-controls {
            position: fixed;
            bottom: 20px;
            left: 0;
            right: 0;
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            padding: 10px;
            z-index: 1000;
        }
        .control-btn {
            background: rgba(255, 255, 255, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.5);
            color: white;
            padding: 15px;
            border-radius: 10px;
            min-width: 50px;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            touch-action: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            cursor: pointer;
        }
        .control-btn:active {
            background: rgba(255, 255, 255, 0.5);
        }
        .control-text {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            text-align: center;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div id="gameInfo">
        <div>ç”Ÿå‘½å€¼: <span id="lives">3</span></div>
        <div>å‡»æ€æ•°: <span id="kills">0</span></div>
        <div>æ—¶é—´: <span id="time">0</span></div>
        <div>åˆ†æ•°: <span id="score">0</span></div>
    </div>
    <canvas id="gameCanvas"></canvas>
    <div id="mobileControls">
        <button class="control-btn" id="leftBtn">â†</button>
        <button class="control-btn" id="fireBtn">ğŸ”¥</button>
        <button class="control-btn" id="rightBtn">â†’</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const livesElement = document.getElementById('lives');
        const killsElement = document.getElementById('kills');
        const timeElement = document.getElementById('time');
        const scoreElement = document.getElementById('score');

        // è®¾ç½®ç”»å¸ƒå¤§å°
        canvas.width = 400;
        canvas.height = 600;

        // æ¸¸æˆçŠ¶æ€
        let score = 0;
        let lives = 3;
        let kills = 0;
        let gameTime = 0;
        let gameOver = false;
        let gamePaused = false; // æ·»åŠ æš‚åœçŠ¶æ€å˜é‡
        let startTime = Date.now();
        let powerUpActive = false;
        let powerUpTimeLeft = 0;
        let powerUpDuration = 5000; // ç‰¹æ®Šèƒ½åŠ›æŒç»­5ç§’
        let enemyCounter = 0; // æ•Œäººè®¡æ•°å™¨
        let lastBulletTime = 0; // ä¸Šæ¬¡å‘å°„å­å¼¹çš„æ—¶é—´
        const bulletCooldown = 300; // å­å¼¹å‘å°„å†·å´æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰

        // é‡‘è‰²æ–¹å—æ•°ç»„
        let powerUps = [];

        // å­å¼¹æ•°ç»„
        let bullets = [];
        const bulletSpeed = 7;

        // æ•Œæœºæ•°ç»„
        let enemies = [];
        const enemySpeed = 3;

        // åˆ›å»ºæ•Œæœº
        function createEnemy() {
            if (Math.random() < 0.02) {
                enemies.push({
                    x: Math.random() * (canvas.width - 30),
                    y: -30,
                    width: 30,
                    height: 30
                });
                enemyCounter++; // æ¯åˆ›å»ºä¸€ä¸ªæ•Œäººå°±è®¡æ•°
                
                // æ¯å½“æ•Œäººæ•°é‡è¾¾åˆ°10çš„å€æ•°æ—¶ï¼Œåˆ›å»ºä¸€ä¸ªé‡‘è‰²æ–¹å—
                if (enemyCounter % 10 === 0) {
                    powerUps.push({
                        x: Math.random() * (canvas.width - 20),
                        y: -20,
                        width: 20,
                        height: 20,
                        speed: 2
                    });
                }
            }
        }

        // æ›´æ–°æ•Œæœºä½ç½®
        function updateEnemies() {
            enemies = enemies.filter(enemy => {
                enemy.y += enemySpeed;
                return enemy.y < canvas.height;
            });
        }

        // ç¢°æ’æ£€æµ‹
        function checkCollisions() {
            // å­å¼¹å‡»ä¸­æ•Œæœº
            for (let i = bullets.length - 1; i >= 0; i--) {
                const bullet = bullets[i];
                let bulletHit = false;
                
                for (let j = enemies.length - 1; j >= 0; j--) {
                    const enemy = enemies[j];
                    if (bullet.x < enemy.x + enemy.width &&
                        bullet.x + bullet.width > enemy.x &&
                        bullet.y < enemy.y + enemy.height &&
                        bullet.y + bullet.height > enemy.y) {
                        // ç§»é™¤è¢«å‡»ä¸­çš„æ•Œæœº
                        enemies.splice(j, 1);
                        // å¢åŠ åˆ†æ•°å’Œå‡»æ€æ•°
                        score += 100;
                        kills++;
                        scoreElement.textContent = score;
                        killsElement.textContent = kills;
                        // æ ‡è®°å­å¼¹å·²å‡»ä¸­æ•Œæœº
                        bulletHit = true;
                        break; // ä¸€æ—¦å‡»ä¸­æ•Œæœºå°±è·³å‡ºå†…å±‚å¾ªç¯
                    }
                }
                
                // å¦‚æœå­å¼¹å‡»ä¸­äº†æ•Œæœºï¼Œåˆ™ç§»é™¤è¯¥å­å¼¹
                if (bulletHit) {
                    bullets.splice(i, 1);
                }
            }

            // ç©å®¶ç¢°åˆ°é‡‘è‰²æ–¹å—
            powerUps.forEach((powerUp, index) => {
                if (player.x < powerUp.x + powerUp.width &&
                    player.x + player.width > powerUp.x &&
                    player.y < powerUp.y + powerUp.height &&
                    player.y + player.height > powerUp.y) {
                    // ç§»é™¤é‡‘è‰²æ–¹å—
                    powerUps.splice(index, 1);
                    // æ¿€æ´»ç‰¹æ®Šèƒ½åŠ›
                    powerUpActive = true;
                    powerUpTimeLeft = 5000; // 5ç§’ç‰¹æ®Šèƒ½åŠ›æ—¶é—´
                    player.speed = 8; // æå‡ç§»åŠ¨é€Ÿåº¦
                }
            });

            // æ•Œæœºæ’å‡»ç©å®¶
            if (!player.invincible) {
                enemies.forEach(enemy => {
                    if (player.x < enemy.x + enemy.width &&
                        player.x + player.width > enemy.x &&
                        player.y < enemy.y + enemy.height &&
                        player.y + player.height > enemy.y) {
                        lives--;
                        livesElement.textContent = lives;
                        if (lives <= 0) {
                            gameOver = true;
                        } else {
                            // è®¾ç½®æ— æ•ŒçŠ¶æ€
                            player.invincible = true;
                            setTimeout(() => {
                                player.invincible = false;
                            }, player.invincibleTime);
                        }
                    }
                });
            }
        }

        // åˆ›å»ºé‡‘è‰²æ–¹å—
        function createPowerUp() {
            // åªåœ¨enemyCounteræ˜¯10çš„å€æ•°ï¼Œä¸”å¤§äº0æ—¶åˆ›å»ºä¸€ä¸ªé‡‘è‰²æ–¹å—
            if (enemyCounter % 10 === 0 && enemyCounter > 0 && powerUps.length === 0) {
                powerUps.push({
                    x: Math.random() * (canvas.width - 20),
                    y: -20,
                    width: 20,
                    height: 20,
                    speed: 2
                });
            }
        }

        // æ›´æ–°é‡‘è‰²æ–¹å—ä½ç½®
        function updatePowerUps() {
            powerUps = powerUps.filter(powerUp => {
                powerUp.y += powerUp.speed;
                return powerUp.y < canvas.height;
            });

            // æ›´æ–°ç‰¹æ®Šèƒ½åŠ›æ—¶é—´
            if (powerUpActive) {
                powerUpTimeLeft = Math.max(0, powerUpTimeLeft - 16); // å‡è®¾60fpsï¼Œçº¦16msæ¯å¸§
                if (powerUpTimeLeft <= 0) {
                    powerUpActive = false;
                    player.speed = 5; // æ¢å¤æ­£å¸¸é€Ÿåº¦
                }
            }
        }
        // ç©å®¶é£æœº
        const player = {
            x: canvas.width / 2,
            y: canvas.height - 50,
            width: 40,
            height: 40,
            speed: 5,
            invincible: false,
            invincibleTime: 2000 // æ— æ•Œæ—¶é—´2ç§’
        };

        // æŒ‰é”®çŠ¶æ€
        const keys = {
            ArrowLeft: false,
            ArrowRight: false,
            ArrowUp: false,
            ArrowDown: false,
            Space: false,
            KeyA: false,
            KeyD: false,
            KeyW: false,
            KeyS: false
        };

        // ç›‘å¬é”®ç›˜äº‹ä»¶
        document.addEventListener('keydown', (e) => {
            if (e.code in keys) {
                keys[e.code] = true;
                
                // ç©ºæ ¼é”®ç”¨äºæš‚åœ/ç»§ç»­æ¸¸æˆ
                if (e.code === 'Space' && !gameOver) {
                    gamePaused = !gamePaused;
                    
                    // å¦‚æœç»§ç»­æ¸¸æˆï¼Œæ›´æ–°å¼€å§‹æ—¶é—´ä»¥é¿å…æ—¶é—´è·³è·ƒ
                    if (!gamePaused) {
                        const pauseDuration = Date.now() - pauseStartTime;
                        startTime += pauseDuration;
                    } else {
                        let pauseStartTime = 0; // è®°å½•æš‚åœå¼€å§‹çš„æ—¶é—´
                        pauseStartTime = Date.now();
                    }
                }
            }
        });

        document.addEventListener('keyup', (e) => {
            if (e.code in keys) {
                keys[e.code] = false;
            }
        });

        // æ›´æ–°ç©å®¶ä½ç½®
        function updatePlayer() {
            if (keys.ArrowLeft && player.x > 0) {
                player.x -= player.speed;
            }
            if (keys.ArrowRight && player.x < canvas.width - player.width) {
                player.x += player.speed;
            }
            if (keys.ArrowUp && player.y > 0) {
                player.y -= player.speed;
            }
            if (keys.ArrowDown && player.y < canvas.height - player.height) {
                player.y += player.speed;
            }
        }

        // åˆ›å»ºå­å¼¹
        function createBullet() {
            const currentTime = Date.now();
            // è‡ªåŠ¨å‘å°„å­å¼¹ï¼Œåªéœ€æ£€æŸ¥å†·å´æ—¶é—´
            if (currentTime - lastBulletTime > bulletCooldown) {
                // æ›´æ–°ä¸Šæ¬¡å‘å°„æ—¶é—´
                lastBulletTime = currentTime;
                
                // åˆ›å»ºä¸­é—´çš„å­å¼¹
                bullets.push({
                    x: player.x + player.width / 2 - 2,
                    y: player.y,
                    width: 4,
                    height: 10,
                    dx: 0 // æ°´å¹³é€Ÿåº¦åˆ†é‡
                });

                // å¦‚æœç‰¹æ®Šèƒ½åŠ›æ¿€æ´»ï¼Œåˆ›å»ºæ–œå‘å­å¼¹
                if (powerUpActive) {
                    // å·¦æ–œå‘å­å¼¹
                    bullets.push({
                        x: player.x + player.width / 2 - 2,
                        y: player.y,
                        width: 4,
                        height: 10,
                        dx: -2 // å‘å·¦çš„é€Ÿåº¦åˆ†é‡
                    });

                    // å³æ–œå‘å­å¼¹
                    bullets.push({
                        x: player.x + player.width / 2 - 2,
                        y: player.y,
                        width: 4,
                        height: 10,
                        dx: 2 // å‘å³çš„é€Ÿåº¦åˆ†é‡
                    });
                }
            }
        }

        // æ›´æ–°å­å¼¹ä½ç½®
        function updateBullets() {
            bullets = bullets.filter(bullet => {
                bullet.y -= bulletSpeed;
                bullet.x += bullet.dx || 0; // æ·»åŠ æ°´å¹³ç§»åŠ¨
                // å­å¼¹åœ¨ç”»å¸ƒèŒƒå›´å†…æ‰ä¿ç•™
                return bullet.y > 0 && bullet.x > 0 && bullet.x < canvas.width;
            });
        }

        // åœ¨drawå‡½æ•°ä¸­æ›´æ–°å­å¼¹ç»˜åˆ¶
        function draw() {
            // æ¸…ç©ºç”»å¸ƒ
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // ç»˜åˆ¶ç©å®¶ï¼ˆæ— æ•ŒçŠ¶æ€é—ªçƒï¼‰
            if (!player.invincible || Math.floor(Date.now() / 100) % 2) {
                ctx.fillStyle = '#0f0';
                ctx.fillRect(player.x, player.y, player.width, player.height);
            }

            // ç»˜åˆ¶å­å¼¹
            ctx.fillStyle = powerUpActive ? '#FFD700' : '#fff'; // ç‰¹æ®Šèƒ½åŠ›æ¿€æ´»æ—¶å­å¼¹ä¸ºé‡‘è‰²
            bullets.forEach(bullet => {
                ctx.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
            });

            // ç»˜åˆ¶æ•Œæœº
            ctx.fillStyle = '#f00';
            enemies.forEach(enemy => {
                ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
            });

            // ç»˜åˆ¶é‡‘è‰²æ–¹å—
            ctx.fillStyle = '#FFD700';
            powerUps.forEach(powerUp => {
                ctx.fillRect(powerUp.x, powerUp.y, powerUp.width, powerUp.height);
            });

            // æ˜¾ç¤ºæš‚åœçŠ¶æ€
            if (gamePaused && !gameOver) {
                ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#fff';
                ctx.font = '48px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('æ¸¸æˆæš‚åœ', canvas.width / 2, canvas.height / 2);
                ctx.font = '24px Arial';
                ctx.fillText('æŒ‰ç©ºæ ¼é”®ç»§ç»­', canvas.width / 2, canvas.height / 2 + 40);
            }

            // æ¸¸æˆç»“æŸ
            if (gameOver) {
                ctx.fillStyle = '#fff';
                ctx.font = '48px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('æ¸¸æˆç»“æŸ', canvas.width / 2, canvas.height / 2);
                ctx.font = '24px Arial';
                ctx.fillText(`æœ€ç»ˆå¾—åˆ†: ${score} å‡»æ€æ•°: ${kills}`, canvas.width / 2, canvas.height / 2 + 40);
                ctx.fillText('æŒ‰ç©ºæ ¼é”®é‡æ–°å¼€å§‹', canvas.width / 2, canvas.height / 2 + 80);
            }
        }

        // æ›´æ–°æ¸¸æˆæ—¶é—´
        function updateTime() {
            if (!gameOver) {
                gameTime = Math.floor((Date.now() - startTime) / 1000);
                timeElement.textContent = gameTime;
            }
        }

        // æ¸¸æˆå¾ªç¯
        function gameLoop() {
            if (!gameOver && !gamePaused) {
                updatePlayer();
                createBullet();
                updateBullets();
                createEnemy();
                updateEnemies();
                createPowerUp();
                updatePowerUps();
                checkCollisions();
                updateTime();
            } else if (gameOver && keys.Space) {
                // é‡ç½®æ¸¸æˆ
                score = 0;
                lives = 3;
                kills = 0;
                gameTime = 0;
                startTime = Date.now();
                enemyCounter = 0; // é‡ç½®æ•Œäººè®¡æ•°å™¨
                scoreElement.textContent = score;
                livesElement.textContent = lives;
                killsElement.textContent = kills;
                timeElement.textContent = gameTime;
                player.x = canvas.width / 2;
                player.invincible = false;
                powerUpActive = false;
                powerUpTimeLeft = 0;
                bullets = [];
                enemies = [];
                powerUps = [];
                gameOver = false;
                gamePaused = false;
            }

            draw();
            requestAnimationFrame(gameLoop);
        }

        // å¼€å§‹æ¸¸æˆ
        gameLoop();

        // æ£€æµ‹æ˜¯å¦ä¸ºç§»åŠ¨è®¾å¤‡
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

        // è°ƒæ•´ç”»å¸ƒå¤§å°
        function resizeCanvas() {
            const maxWidth = window.innerWidth - 20;
            const maxHeight = window.innerHeight - 150;
            const ratio = 400 / 600;

            let newWidth = maxWidth;
            let newHeight = maxWidth / ratio;

            if (newHeight > maxHeight) {
                newHeight = maxHeight;
                newWidth = maxHeight * ratio;
            }

            canvas.width = newWidth;
            canvas.height = newHeight;

            // è°ƒæ•´ç©å®¶ä½ç½®
            player.x = canvas.width / 2;
            player.y = canvas.height - 50;
        }

        // ç›‘å¬çª—å£å¤§å°å˜åŒ–
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        // ç§»åŠ¨è®¾å¤‡æ§åˆ¶
        if (isMobile) {
            const leftBtn = document.getElementById('leftBtn');
            const rightBtn = document.getElementById('rightBtn');
            const fireBtn = document.getElementById('fireBtn');
            
            // ä¿®æ”¹å‘å°„æŒ‰é’®ä¸ºæš‚åœæŒ‰é’®
            fireBtn.innerHTML = 'â¸ï¸';
        
            // è§¦æ‘¸æ§åˆ¶
            const handleTouchStart = (e, key) => {
                e.preventDefault();
                e.stopPropagation(); // æ·»åŠ è¿™ä¸€è¡Œé˜»æ­¢äº‹ä»¶å†’æ³¡
                
                if (key === 'Space') {
                    // ç©ºæ ¼é”®ç”¨äºæš‚åœ/ç»§ç»­æ¸¸æˆ
                    if (!gameOver) {
                        gamePaused = !gamePaused;
                        
                        // å¦‚æœç»§ç»­æ¸¸æˆï¼Œæ›´æ–°å¼€å§‹æ—¶é—´ä»¥é¿å…æ—¶é—´è·³è·ƒ
                        if (!gamePaused) {
                            const pauseDuration = Date.now() - pauseStartTime;
                            startTime += pauseDuration;
                        } else {
                            // è®°å½•æš‚åœå¼€å§‹æ—¶é—´
                            pauseStartTime = Date.now();
                        }
                    }
                } else {
                    keys[key] = true;
                }
            };
        
            const handleTouchEnd = (e, key) => {
                e.preventDefault();
                e.stopPropagation(); // æ·»åŠ è¿™ä¸€è¡Œé˜»æ­¢äº‹ä»¶å†’æ³¡
                keys[key] = false;
            };
        
            leftBtn.addEventListener('touchstart', (e) => handleTouchStart(e, 'ArrowLeft'));
            leftBtn.addEventListener('touchend', (e) => handleTouchEnd(e, 'ArrowLeft'));
        
            rightBtn.addEventListener('touchstart', (e) => handleTouchStart(e, 'ArrowRight'));
            rightBtn.addEventListener('touchend', (e) => handleTouchEnd(e, 'ArrowRight'));
        
            fireBtn.addEventListener('touchstart', (e) => handleTouchStart(e, 'Space'));
            fireBtn.addEventListener('touchend', (e) => handleTouchEnd(e, 'Space'));
        
            // æ·»åŠ è§¦æ‘¸å–æ¶ˆäº‹ä»¶å¤„ç†
            leftBtn.addEventListener('touchcancel', (e) => handleTouchEnd(e, 'ArrowLeft'));
            rightBtn.addEventListener('touchcancel', (e) => handleTouchEnd(e, 'ArrowRight'));
            fireBtn.addEventListener('touchcancel', (e) => handleTouchEnd(e, 'Space'));
        
            // éšè—ç§»åŠ¨ç«¯åŒå‡»ç¼©æ”¾
            document.documentElement.addEventListener('touchstart', (e) => {
                if (e.touches.length > 1) {
                    e.preventDefault();
                }
            }, { passive: false });

            // ç¦æ­¢é¡µé¢æ»šåŠ¨
            document.body.addEventListener('touchmove', (e) => {
                e.preventDefault();
            }, { passive: false });
        } else {
            // åœ¨éç§»åŠ¨è®¾å¤‡ä¸Šéšè—æ§åˆ¶æŒ‰é’®
            document.getElementById('mobileControls').style.display = 'none';
        }
    </script>
</body>
</html>

<style>
    #lastModified {
        position: fixed;
        top: 10px;
        right: 10px;
        color: #fff;
        font-size: 14px;
        font-family: Arial, sans-serif;
        background: rgba(0, 0, 0, 0.5);
        padding: 5px 10px;
        border-radius: 5px;
        z-index: 100;
    }
</style>

<!-- åœ¨ gameInfo div åæ·»åŠ  -->
<div id="lastModified"></div>

<script>
// åœ¨æ¸¸æˆå¾ªç¯å¼€å§‹å‰æ·»åŠ 
const lastModifiedElement = document.getElementById('lastModified');

// è·å–å¹¶æ˜¾ç¤ºæœ€åä¿®æ”¹æ—¶é—´
fetch(window.location.href)
    .then(response => {
        const lastModified = response.headers.get('last-modified');
        if (lastModified) {
            const date = new Date(lastModified);
            const formattedDate = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
            const formattedTime = `${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
            lastModifiedElement.textContent = `æœ€åæ›´æ–°: ${formattedDate} ${formattedTime}`;
        } else {
            lastModifiedElement.textContent = 'æœ€åæ›´æ–°æ—¶é—´æœªçŸ¥';
        }
    })
    .catch(() => {
        lastModifiedElement.textContent = 'æœ€åæ›´æ–°æ—¶é—´æœªçŸ¥';
    });
</script>